## 大数据分析实验报告——聚类

### 苏致成 201250104



### 注明：

本文档采用markdown书写，因此，转为word部分公式可能出现显示异常等问题。



### 使用方法

#### SimpleKMeans

聚类属于无监督学习，KMeans聚类是最基础常用的聚类算法，其基本思想是，通过迭代寻找k个聚簇的一种划分方案，使得聚类结果对应的损失函数最小。其中，损失函数可以定义为各个样本距离所属聚簇中心点的误差平方和。即：
$$
J(c,μ)=\sum_{i=1}^{M}||x_{i}-μ_{c_{i}}||^{2}
$$
其中， $x_{i}$ 代表第 $i$ 个样本，$c_{i}$ 是 $x_{i}$ 所属的聚簇，$μ_{c_{i}}$ 代表聚簇对应的中心点，$M$ 代表样本总数。

核心部分即为先固定中心点，调整样本所属类别来减少 $J$ ;再固定每个样本类别，调整中心点继续减小 $J$ 。两个过程交替循环， $J$ 单调递减直到最小值，中心点和样本划分的类别同时收敛。





##### 算法流程

1. 数据预处理。包括标准化、异常点过滤等。

2. 随机选取k个中心，记为 $μ_{1}^{(0)},μ_{2}^{(0)},...,μ_{k}^{(0)}$ 。

3. 定义损失函数：$J(c,μ)=min\sum_{i=1}^{M}||x_{i}-μ_{c_{i}}||^2$ 。

4. 令 $t=0,1,2...$ 为迭代次数，重复如下过程直至 $J$ 收敛：

   + 对于每一个样本 $x_{i}$ ，将其分配到距离最近的中心，即：
     $$
     c_{i}^{t}<- argmin_{k}||x_{i}-μ_{k}^{t} ||^2
     $$
     
+ 对于每一个类中心 $k$ ,重新计算该类的中心。即：
     $$
     μ_{k}^{(t+1)}<-argmin_{μ}\sum_{i:c_{i}^{t}=k}^{b}||x_{i}-μ||^2
     $$
     



#### EM

EM算法是一种迭代优化策略，它的每一轮迭代过程都分为两步，一个是期望步（E步），另一个是极大步（M步）。基本思想是根据观测值，估计出模型参数的值，然后再根据上一步估计出的参数值估计缺失数据的值，然后再根据估计出的缺失数据加上观测值重新再对参数值进行估计，反复迭代，直至收敛。

缺点：对初始值敏感，聚类结果随不同的初始值波动较大。



##### 算法流程

1. 输入观察的数据 $x=(x_{1},x_{2},...,x_{n})$ ，联合分布 $p(x,z;\theta)$ ,条件分布 $p(z|z,\theta)$ ,最大迭代次数 $J$ 。

2. 随机初始化模型参数 $\theta$ 的初值 $\theta_{0}$ 。

3. 令 $j=1,2,...J$ 开始 $EM$ 算法迭代步骤：

   + E步骤：计算联合分布的条件概率期望：
     $$
     Q_{i}(z_{i})=p(z_{i}|x_{i},\theta_{j})\\
     l(\theta,\theta_{j})=\sum_{i=1}^{n}\sum_{z_{i}}Q_{i}(z_{i})log\frac{p(x_{i},z_{i};\theta)}{Q_{i}(z_{i})}
     $$
     
+ M步骤：极大化 $l(\theta,\theta_{j})$ ,得到 $\theta_{j+1}$ ：
     $$
     \theta_{j+1}=argmaxl(\theta,\theta_{j})
     $$
     
   + 若 $\theta_{j+1}$ 已经收敛，则算法结束。否则继续进行E步骤和M步骤进行迭代。

 

### 数据集处理思路

#### SimpleKMeans

1. 缺失值处理。将含有缺失值的条目均去除。
2. 读入 $iris.arff$，调用 $SimpleKMeans$ ,并且将其聚类的数量设置为3（注：在KMeans中聚类的数目k的值一般比较难以确定，此处确定为3的部分原因是已知其结果的可靠性）。
3. 输出结果。



#### EM

1. 缺失值处理：观察数据集可知，并无缺失数据值。
2. 读入 $iris.arff$，调用 $setClassIndex$ 将最后一列属性不予纳入聚类考虑。
3. 设置最大迭代次数为100，并且聚簇的数目是3。
4. 打印出对数似然度量等值。

 

### 实验结果

#### SimpleKMeans

观察到KMeans方法正好分为3种类别的鸢尾属植物。

可以观察到诸如花瓣宽度方面， $virginica$ 明显比 $setosa$ 高等指标信息。 

![image-20221010114434267](C:\Users\Dudu\AppData\Roaming\Typora\typora-user-images\image-20221010114434267.png)





#### EM

从下图可知每个类的分类聚簇后各类的数量、各项指标等信息。

可以观察到诸如花瓣宽度方面， $virginica$ 明显比 $setosa$ 高等指标信息。 

<img src="C:\Users\Dudu\AppData\Roaming\Typora\typora-user-images\image-20221010115643829.png" alt="image-20221010115643829" style="zoom:67%;" />



并且根据下图可知，聚类过程很好地将三个子类进行了划分，并且错误率（9.3333%）较低。

<img src="C:\Users\Dudu\AppData\Roaming\Typora\typora-user-images\image-20221010115749967.png" alt="image-20221010115749967" style="zoom:67%;" />

